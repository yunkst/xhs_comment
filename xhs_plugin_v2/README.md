# 小红书网络请求监控插件 v2

## 功能简介

这是一个Chrome浏览器扩展插件，专门用于监控和记录所有发往 `xiaohongshu.com` 域名的网络请求。该插件可以帮助开发者分析小红书网站的API调用、请求模式和数据交互。

## 主要功能

### 🔍 网络请求监控
- 自动拦截并记录所有发往小红书的HTTP/HTTPS请求
- 支持监控多种请求类型：
  - WebRequest API拦截的标准请求
  - Fetch API请求
  - XMLHttpRequest请求
  - 图片加载请求
  - 动态脚本加载请求

### 📊 详细信息记录
每个请求都会记录以下信息：
- 请求URL
- HTTP方法 (GET, POST, PUT, DELETE等)
- 请求头和响应头
- 请求体数据
- 响应状态码
- 时间戳
- 请求类型
- 错误信息（如果有）

### 🎯 用户界面功能
- **实时监控面板**：通过点击扩展图标查看实时请求数据
- **请求过滤**：支持按URL和HTTP方法过滤请求
- **详细信息展示**：点击任意请求查看完整的请求/响应详情
- **数据导出**：将请求日志导出为JSON格式
- **数据清理**：一键清空所有记录的请求
- **徽章计数**：扩展图标显示当前记录的请求数量

## 安装方法

### 1. 开发者模式安装
1. 打开Chrome浏览器
2. 访问 `chrome://extensions/`
3. 启用"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 `xhs_plugin_v2` 文件夹

### 2. 权限说明
插件需要以下权限：
- `webRequest`: 拦截网络请求
- `storage`: 保存请求数据到本地
- `tabs`: 访问标签页信息
- `activeTab`: 访问当前活动标签页
- `*://*.xiaohongshu.com/*`: 小红书域名访问权限

## 使用说明

### 1. 启动监控
- 安装插件后会自动开始监控
- 访问任何小红书页面即可开始记录请求

### 2. 查看请求数据
- 点击浏览器工具栏中的插件图标
- 在弹出窗口中查看所有拦截的请求
- 使用搜索框过滤特定URL
- 使用下拉菜单过滤特定HTTP方法

### 3. 查看详细信息
- 点击任意请求项展开详细信息
- 可以查看完整的请求头、响应头、请求体等

### 4. 导出数据
- 点击"导出JSON"按钮将数据保存为文件
- 导出的文件包含所有请求的完整信息

### 5. 清理数据
- 点击"清空日志"按钮删除所有记录
- 数据清理后插件将重新开始记录

## 技术架构

### 核心组件
1. **manifest.json**: 插件配置文件，定义权限和组件
2. **background.js**: 后台脚本，使用WebRequest API拦截请求
3. **content.js**: 内容脚本，在页面中注入监控代码
4. **injected.js**: 注入脚本，拦截页面中的fetch/XHR请求
5. **popup.html/css/js**: 用户界面，显示和管理请求数据

### 监控机制
- **WebRequest API**: 在网络层面拦截所有HTTP请求
- **Fetch/XHR拦截**: 通过重写原生API拦截JavaScript发起的请求
- **DOM监控**: 监控动态添加的资源请求

### 数据存储
- 使用Chrome Storage API本地存储请求数据
- 最多保存1000条请求记录
- 支持数据持久化，重启浏览器后数据不丢失

## 开发相关

### 文件结构
```
xhs_plugin_v2/
├── manifest.json          # 插件配置
├── background.js          # 后台脚本
├── content.js             # 内容脚本
├── injected.js            # 注入脚本
├── popup.html             # 弹窗界面
├── popup.css              # 弹窗样式
├── popup.js               # 弹窗逻辑
├── icons/                 # 图标文件夹
└── README.md              # 说明文档
```

### 调试方法
1. 在 `chrome://extensions/` 中点击"检查视图"可以调试弹窗
2. 在页面中按F12可以看到注入脚本的日志
3. 在扩展管理页面可以查看后台脚本的日志

## 注意事项

### 隐私安全
- 插件仅监控小红书相关域名的请求
- 所有数据仅存储在本地，不会上传到远程服务器
- 用户可以随时清空或导出数据

### 性能影响
- 插件经过优化，对页面性能影响很小
- 最多保存1000条记录，避免内存溢出
- 使用事件驱动模式，不会持续消耗CPU

### 兼容性
- 支持Chrome 88及以上版本
- 使用Manifest V3规范
- 兼容最新的Web API标准

## 更新日志

### v1.0.0 (初始版本)
- 基础网络请求监控功能
- 用户界面和数据展示
- 数据导出和清理功能
- 多种请求类型支持

## 重要更新

### API路径迁移

插件API接口已全面迁移到新的域名空间结构。所有API调用现在使用以下格式：

```
/api/v1/{领域}/{资源}
```

更多信息请参阅 [API_MIGRATION.md](./API_MIGRATION.md)

## 支持与反馈

如果在使用过程中遇到问题或有改进建议，请通过以下方式联系：
- GitHub Issues
- 邮件反馈

## 开源协议

本项目基于 Apache License 2.0 开源协议。 