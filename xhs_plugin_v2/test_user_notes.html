<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·å¤‡æ³¨åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-container {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
        }
        .test-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .test-content {
            color: #666;
            margin-bottom: 10px;
        }
        .test-user {
            color: #ff2442;
            font-weight: bold;
        }
        .test-time {
            color: #999;
            font-size: 12px;
        }
        .note-input {
            position: absolute;
            right: 20px;
            top: 20px;
            width: 200px;
            min-height: 60px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: none;
            font-size: 12px;
        }
        .status {
            margin-top: 20px;
            padding: 10px;
            border-radius: 4px;
        }
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .button {
            background-color: #ff2442;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background-color: #e6213d;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª ç”¨æˆ·å¤‡æ³¨åŠŸèƒ½æµ‹è¯•é¡µé¢</h1>
    
    <div class="status info">
        <strong>æµ‹è¯•è¯´æ˜ï¼š</strong>
        <ul>
            <li>æ­¤é¡µé¢æ¨¡æ‹Ÿå°çº¢ä¹¦é€šçŸ¥é¡µé¢çš„ç»“æ„</li>
            <li>è¯·ç¡®ä¿æ’ä»¶å·²æ­£ç¡®åŠ è½½</li>
            <li>æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—æŸ¥çœ‹åŠŸèƒ½çŠ¶æ€</li>
            <li>å¤‡æ³¨è¾“å…¥æ¡†åº”è¯¥è‡ªåŠ¨å‡ºç°åœ¨æ¯ä¸ªé€šçŸ¥çš„å³ä¾§</li>
        </ul>
    </div>

    <!-- æ¨¡æ‹Ÿé€šçŸ¥å®¹å™¨ -->
    <div class="tabs-content-container">
        <!-- é€šçŸ¥1 -->
        <div class="container test-container">
            <div class="test-title">
                <span class="test-user">@ç”¨æˆ·123</span> èµäº†ä½ çš„ç¬”è®°
            </div>
            <div class="test-content">
                è¿™æ˜¯ä¸€æ¡å…³äºæŠ¤è‚¤çš„ç¬”è®°ï¼Œåˆ†äº«äº†ä¸€äº›å®ç”¨çš„æŠ¤è‚¤æŠ€å·§...
            </div>
            <div class="test-time">2å°æ—¶å‰</div>
        </div>

        <!-- é€šçŸ¥2 -->
        <div class="container test-container">
            <div class="test-title">
                <span class="test-user">@ç¾å¦†è¾¾äºº</span> è¯„è®ºäº†ä½ çš„ç¬”è®°
            </div>
            <div class="test-content">
                "è¿™ä¸ªäº§å“çœŸçš„å¾ˆå¥½ç”¨ï¼Œæˆ‘ä¹Ÿä¹°äº†åŒæ¬¾ï¼"
            </div>
            <div class="test-time">5å°æ—¶å‰</div>
        </div>

        <!-- é€šçŸ¥3 -->
        <div class="container test-container">
            <div class="test-title">
                <span class="test-user">@æ—…è¡Œçˆ±å¥½è€…</span> å…³æ³¨äº†ä½ 
            </div>
            <div class="test-content">
                æœŸå¾…çœ‹åˆ°æ›´å¤šç²¾å½©å†…å®¹ï¼
            </div>
            <div class="test-time">1å¤©å‰</div>
        </div>
    </div>

    <div class="status" id="status">
        ç­‰å¾…æ’ä»¶åˆå§‹åŒ–...
    </div>

    <div style="margin-top: 20px;">
        <button class="button" onclick="testPluginStatus()">æ£€æŸ¥æ’ä»¶çŠ¶æ€</button>
        <button class="button" onclick="testApiService()">æµ‹è¯•APIæœåŠ¡</button>
        <button class="button" onclick="testUserNotes()">æµ‹è¯•å¤‡æ³¨åŠŸèƒ½</button>
        <button class="button" onclick="clearStatus()">æ¸…é™¤çŠ¶æ€</button>
    </div>

    <script>
        // æµ‹è¯•å‡½æ•°
        function updateStatus(message, type = 'info') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
            console.log(`[Test] ${message}`);
        }

        function testPluginStatus() {
            updateStatus('æ£€æŸ¥æ’ä»¶çŠ¶æ€...', 'info');
            
            // æ£€æŸ¥å…¨å±€å¯¹è±¡æ˜¯å¦å­˜åœ¨
            const checks = [
                { name: 'xhsApiService', obj: window.xhsApiService },
                { name: 'xhsUserNotes', obj: window.xhsUserNotes },
                { name: 'xhsDialogManager', obj: window.xhsDialogManager }
            ];
            
            let allPassed = true;
            let results = [];
            
            checks.forEach(check => {
                if (check.obj) {
                    results.push(`âœ… ${check.name}: å·²åŠ è½½`);
                } else {
                    results.push(`âŒ ${check.name}: æœªåŠ è½½`);
                    allPassed = false;
                }
            });
            
            const message = results.join('\n');
            updateStatus(message, allPassed ? 'success' : 'error');
        }

        function testApiService() {
            updateStatus('æµ‹è¯•APIæœåŠ¡...', 'info');
            
            if (!window.xhsApiService) {
                updateStatus('âŒ APIæœåŠ¡æœªåŠ è½½', 'error');
                return;
            }
            
            // æµ‹è¯•é…ç½®è·å–
            window.xhsApiService.testGetApiConfig()
                .then(config => {
                    updateStatus(`âœ… APIé…ç½®è·å–æˆåŠŸ: ${config.apiBaseUrl}`, 'success');
                })
                .catch(error => {
                    updateStatus(`âŒ APIé…ç½®è·å–å¤±è´¥: ${error.message}`, 'error');
                });
        }

        function testUserNotes() {
            updateStatus('æµ‹è¯•ç”¨æˆ·å¤‡æ³¨åŠŸèƒ½...', 'info');
            
            if (!window.xhsUserNotes) {
                updateStatus('âŒ ç”¨æˆ·å¤‡æ³¨æ¨¡å—æœªåŠ è½½', 'error');
                return;
            }
            
            // æ¨¡æ‹Ÿé€šçŸ¥æ•°æ®
            const mockNotification = {
                userInfo: { id: 'test_user_123' },
                content: 'è¿™æ˜¯ä¸€æ¡æµ‹è¯•é€šçŸ¥å†…å®¹',
                type: 'like'
            };
            
            // æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå®¹å™¨
            const container = document.querySelector('.container');
            if (container) {
                try {
                    window.xhsUserNotes.addNoteInputToContainer(container, 'test_user_123', mockNotification);
                    updateStatus('âœ… å¤‡æ³¨è¾“å…¥æ¡†æ·»åŠ æˆåŠŸ', 'success');
                } catch (error) {
                    updateStatus(`âŒ å¤‡æ³¨åŠŸèƒ½æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                updateStatus('âŒ æœªæ‰¾åˆ°æµ‹è¯•å®¹å™¨', 'error');
            }
        }

        function clearStatus() {
            updateStatus('çŠ¶æ€å·²æ¸…é™¤', 'info');
        }

        // è‡ªåŠ¨æ£€æŸ¥æ’ä»¶çŠ¶æ€
        setTimeout(() => {
            testPluginStatus();
        }, 2000);

        // ç›‘å¬æ’ä»¶åŠ è½½äº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus('é¡µé¢åŠ è½½å®Œæˆï¼Œç­‰å¾…æ’ä»¶åˆå§‹åŒ–...', 'info');
        });

        // æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡æ’ä»¶çŠ¶æ€
        setInterval(() => {
            const noteInputs = document.querySelectorAll('.xhs-note-input');
            if (noteInputs.length > 0) {
                updateStatus(`âœ… å‘ç° ${noteInputs.length} ä¸ªå¤‡æ³¨è¾“å…¥æ¡†`, 'success');
            }
        }, 5000);
    </script>
</body>
</html> 