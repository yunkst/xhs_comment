import{_ as G,r as J,a as _,c as $,b as e,w as t,d as n,g as v,k as h,l as S,h as r,i as y,u as B,n as K,p as O,q as P,E as c,s as E}from"./index-B90Amhi_.js";const Q={class:"system-container"},W={class:"backup-actions"},X={key:0,class:"backup-history"},Z={__name:"SystemView",setup(ee){const o=J({passwordExpiration:90,loginLockEnabled:!0,loginLockThreshold:5,loginLockTime:30,sessionTimeout:120}),w=_(!1),T=_(!1),V=_([]),f=_(null),p=_([{filename:"backup_20230615120000.zip",size:"5.2MB",createTime:"2023-06-15 12:00:00"},{filename:"backup_20230610090000.zip",size:"5.1MB",createTime:"2023-06-10 09:00:00"},{filename:"backup_20230601180000.zip",size:"4.9MB",createTime:"2023-06-01 18:00:00"}]),C=()=>{c.success("安全设置保存成功")},z=()=>{o.passwordExpiration=90,o.loginLockEnabled=!0,o.loginLockThreshold=5,o.loginLockTime=30,o.sessionTimeout=120,c.info("安全设置已重置")},M=()=>{w.value=!0,setTimeout(()=>{const a=new Date,l=a.getFullYear(),d=String(a.getMonth()+1).padStart(2,"0"),b=String(a.getDate()).padStart(2,"0"),i=String(a.getHours()).padStart(2,"0"),g=String(a.getMinutes()).padStart(2,"0"),m=String(a.getSeconds()).padStart(2,"0"),u=`backup_${l}${d}${b}${i}${g}${m}.zip`;p.value.unshift({filename:u,size:"5.3MB",createTime:`${l}-${d}-${b} ${i}:${g}:${m}`}),w.value=!1,c.success("数据备份成功")},2e3)},F=a=>{V.value=[a],f.value=a},U=()=>{if(!f.value){c.warning("请先选择备份文件");return}E.confirm("恢复操作将覆盖当前数据，是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{T.value=!0,setTimeout(()=>{T.value=!1,V.value=[],f.value=null,c.success("数据恢复成功")},2e3)}).catch(()=>{})},N=a=>{c.success(`正在下载备份文件: ${a.filename}`)},R=a=>{E.confirm(`确定要删除备份文件 ${a.filename} 吗?`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{p.value=p.value.filter(l=>l.filename!==a.filename),c.success("备份文件删除成功")}).catch(()=>{})};return(a,l)=>{const d=n("el-option"),b=n("el-select"),i=n("el-form-item"),g=n("el-switch"),m=n("el-input-number"),u=n("el-button"),D=n("el-form"),L=n("el-tab-pane"),H=n("el-alert"),x=n("el-icon"),q=n("el-upload"),k=n("el-table-column"),I=n("el-table"),Y=n("el-tabs"),j=n("el-card");return v(),$("div",Q,[e(j,{class:"system-card"},{header:t(()=>l[5]||(l[5]=[y("div",{class:"card-header"},[y("h3",null,"系统设置")],-1)])),default:t(()=>[e(Y,{type:"border-card"},{default:t(()=>[e(L,{label:"安全设置"},{default:t(()=>[e(D,{model:o,"label-width":"180px"},{default:t(()=>[e(i,{label:"登录密码有效期"},{default:t(()=>[e(b,{modelValue:o.passwordExpiration,"onUpdate:modelValue":l[0]||(l[0]=s=>o.passwordExpiration=s)},{default:t(()=>[e(d,{label:"永不过期",value:0}),e(d,{label:"30天",value:30}),e(d,{label:"60天",value:60}),e(d,{label:"90天",value:90})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"登录失败锁定"},{default:t(()=>[e(g,{modelValue:o.loginLockEnabled,"onUpdate:modelValue":l[1]||(l[1]=s=>o.loginLockEnabled=s)},null,8,["modelValue"])]),_:1}),o.loginLockEnabled?(v(),h(i,{key:0,label:"失败次数锁定阈值"},{default:t(()=>[e(m,{modelValue:o.loginLockThreshold,"onUpdate:modelValue":l[2]||(l[2]=s=>o.loginLockThreshold=s),min:1,max:10},null,8,["modelValue"])]),_:1})):S("",!0),o.loginLockEnabled?(v(),h(i,{key:1,label:"锁定时间(分钟)"},{default:t(()=>[e(m,{modelValue:o.loginLockTime,"onUpdate:modelValue":l[3]||(l[3]=s=>o.loginLockTime=s),min:1,max:1440},null,8,["modelValue"])]),_:1})):S("",!0),e(i,{label:"会话超时时间(分钟)"},{default:t(()=>[e(m,{modelValue:o.sessionTimeout,"onUpdate:modelValue":l[4]||(l[4]=s=>o.sessionTimeout=s),min:1,max:1440},null,8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(u,{type:"primary",onClick:C},{default:t(()=>l[6]||(l[6]=[r("保存设置")])),_:1}),e(u,{onClick:z},{default:t(()=>l[7]||(l[7]=[r("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(L,{label:"备份恢复"},{default:t(()=>[e(H,{title:"数据备份与恢复",type:"info",closable:!1,description:"您可以备份系统数据或恢复之前的备份，请谨慎操作以免数据丢失。","show-icon":"",style:{"margin-bottom":"20px"}}),y("div",W,[e(u,{type:"primary",onClick:M,loading:w.value},{default:t(()=>[e(x,null,{default:t(()=>[e(B(K))]),_:1}),l[8]||(l[8]=r(" 备份数据 "))]),_:1},8,["loading"]),e(q,{class:"upload-backup",action:"#","auto-upload":!1,"on-change":F,"file-list":V.value},{default:t(()=>[e(u,{type:"warning"},{default:t(()=>[e(x,null,{default:t(()=>[e(B(O))]),_:1}),l[9]||(l[9]=r(" 选择备份文件 "))]),_:1})]),_:1},8,["file-list"]),e(u,{type:"danger",onClick:U,disabled:!f.value,loading:T.value},{default:t(()=>[e(x,null,{default:t(()=>[e(B(P))]),_:1}),l[10]||(l[10]=r(" 恢复数据 "))]),_:1},8,["disabled","loading"])]),p.value.length>0?(v(),$("div",X,[l[13]||(l[13]=y("h4",null,"备份历史",-1)),e(I,{data:p.value,style:{width:"100%"}},{default:t(()=>[e(k,{prop:"filename",label:"文件名"}),e(k,{prop:"size",label:"大小",width:"120"}),e(k,{prop:"createTime",label:"创建时间",width:"180"}),e(k,{label:"操作",width:"180"},{default:t(s=>[e(u,{size:"small",onClick:A=>N(s.row)},{default:t(()=>l[11]||(l[11]=[r("下载")])),_:2},1032,["onClick"]),e(u,{size:"small",type:"danger",onClick:A=>R(s.row)},{default:t(()=>l[12]||(l[12]=[r("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])):S("",!0)]),_:1})]),_:1})]),_:1})])}}},te=G(Z,[["__scopeId","data-v-a3d95add"]]);export{te as default};
